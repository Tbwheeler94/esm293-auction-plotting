---
title: "graph_auction"
author: "Tom Wheeler"
date: "5/2/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(plotly)

data <- read_csv('auctiondata.csv')

data$right <- cumsum(data$mw)
data$left <- data$right - data$mw 

p1 <- ggplot(data) + 
    geom_rect(aes(xmin = left, xmax = right, ymax = mc, fill = plant, ymin =0)) +
    xlab("generation") + 
    ylab("value") +
    geom_abline(aes(intercept=11055,slope=-1)) 

ggplotly(p1)

```

```{r}
p2 <- ggplot(data) + 
    geom_rect(aes(xmin = left, xmax = right, ymax = mc, fill = plant, ymin =0)) +
    xlab("generation") + 
    ylab("value") +
    geom_abline(aes(intercept=19145,slope=-1.27)) 

ggplotly(p2)
```

```{r}
p3 <- ggplot(data) + 
    geom_rect(aes(xmin = left, xmax = right, ymax = mc, fill = plant, ymin =0)) +
    xlab("generation") + 
    ylab("value") +
    geom_abline(aes(intercept=25807,slope=-1.2)) 

ggplotly(p3)
```

```{r}
p4 <- ggplot(data) + 
    geom_rect(aes(xmin = left, xmax = right, ymax = mc, fill = plant, ymin =0)) +
    xlab("generation") + 
    ylab("value") +
    geom_abline(aes(intercept=23928,slope=-1.27)) 

ggplotly(p4)
```

